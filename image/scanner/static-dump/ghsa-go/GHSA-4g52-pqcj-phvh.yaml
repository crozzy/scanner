description: |-
  ### Impact

  1. BLS signature validation in lotus uses blst library method VerifyCompressed. This method accepts signatures in 2 forms - "serialized", and "compressed", meaning that BLS signatures can be provided as either of 2 unique byte arrays.
  2. Lotus block validation functions perform a uniqueness check on provided blocks. Two blocks are considered distinct if the CIDs of their blockheader do not match. The CID method for blockheader includes the BlockSig of the block.

  The result of these issues is that it would be possible to punish miners for valid blocks, as there are two different valid block CIDs available for each block, even though this must be unique.

  ### Patches

  By switching from the go based `blst` bindings over to the bindings in `filecoin-ffi`, the code paths now ensure that all signatures are compressed by size and the way they are deserialized.
  This happened in https://github.com/filecoin-project/lotus/pull/5393


  ### References

  - Original POC: https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754
ghsaId: GHSA-4g52-pqcj-phvh
identifiers:
- type: GHSA
  value: GHSA-4g52-pqcj-phvh
- type: CVE
  value: CVE-2021-21405
permalink: https://github.com/advisories/GHSA-4g52-pqcj-phvh
publishedAt: "2021-05-21T16:23:43Z"
references:
- url: https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
- url: https://github.com/advisories/GHSA-4g52-pqcj-phvh
summary: BLS Signature "Malleability"
updatedAt: "2021-05-21T16:23:43Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 1.5.0
  package:
    name: github.com/filecoin-project/lotus
  severity: MODERATE
  updatedAt: "2021-05-20T20:51:01Z"
  vulnerableVersionRange: < 1.5.0
