description: |-
  ### Impact
  When running processes using "chroot" isolation, the process being run can examine the environment variables of its immediate parent and grandparent processes (CVE-2021-3602).  This isolation type is often used when running `buildah` in unprivileged containers, and it is often used to do so in CI/CD environments.  If sensitive information is exposed to the original `buildah` process through its environment, that information will unintentionally be shared with child processes which it starts as part of handling RUN instructions or during `buildah run`.  The commands that `buildah` is instructed to run can read that information if they choose to.

  ### Patches
  Users should upgrade packages, or images which contain packages, to include version 1.21.3 or later.

  ### Workarounds
  As a workaround, invoking `buildah` in a container under `env -i` to have it started with a reinitialized environment should prevent the leakage.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [buildah](https://github.com/containers/buildah/issues)
  * Email us at [the buildah general mailing list](mailto:buildah@lists.buildah.io), or [the podman security mailing list](mailto:security@lists.podman.io) if it's sensitive.
ghsaId: GHSA-7638-r9r3-rmjj
identifiers:
- type: GHSA
  value: GHSA-7638-r9r3-rmjj
- type: CVE
  value: CVE-2021-3602
permalink: https://github.com/advisories/GHSA-7638-r9r3-rmjj
publishedAt: "2021-07-19T15:19:09Z"
references:
- url: https://github.com/containers/buildah/security/advisories/GHSA-7638-r9r3-rmjj
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-3602
- url: https://github.com/advisories/GHSA-7638-r9r3-rmjj
summary: 'chroot isolation: environment value leakage to intermediate processes'
updatedAt: "2021-07-19T15:19:09Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 1.21.3
  package:
    name: github.com/containers/buildah
  severity: MODERATE
  updatedAt: "2021-07-15T20:26:58Z"
  vulnerableVersionRange: '>= 1.20.0, <= 1.21.2'
- firstPatchedVersion:
    identifier: 1.19.9
  package:
    name: github.com/containers/buildah
  severity: MODERATE
  updatedAt: "2021-07-15T20:26:58Z"
  vulnerableVersionRange: '>= 1.18.0, <= 1.19.8'
- firstPatchedVersion:
    identifier: 1.17.2
  package:
    name: github.com/containers/buildah
  severity: MODERATE
  updatedAt: "2021-07-15T20:26:58Z"
  vulnerableVersionRange: '>= 1.17.0, <= 1.17.1'
- firstPatchedVersion:
    identifier: 1.16.8
  package:
    name: github.com/containers/buildah
  severity: MODERATE
  updatedAt: "2021-07-15T20:26:58Z"
  vulnerableVersionRange: <= 1.16.7
