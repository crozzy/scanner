description: "Envoy, which Pomerium is based on, can abnormally terminate if an H/2
  GOAWAY and SETTINGS frame are received in the same IO event.  \n\n### Impact\nThis
  can lead to a DoS in the presence of untrusted *upstream* servers.\n\n### Patches\n0.15.1
  contains an upgraded envoy binary with this vulnerability patched.\n\n### Workarounds\nIf
  only trusted upstreams are configured, there is not substantial risk of this condition
  being triggered.\n\n### References\n[envoy GSA](https://github.com/envoyproxy/envoy/security/advisories/GHSA-j374-mjrw-vvp8)\n[envoy
  CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32780)\n[envoy announcement](https://groups.google.com/g/envoy-announce/c/5xBpsEZZDfE/m/wD05NZBbAgAJ)\n\n###
  For more information\nIf you have any questions or comments about this advisory:\n*
  Open an issue in [pomerium/pomerium](https://github.com/pomerium/pomerium/issues)\n*
  Email us at [security@pomerium.com](mailto:security@pomerium.com)\n\n"
ghsaId: GHSA-gjcg-vrxg-xmgv
identifiers:
- type: GHSA
  value: GHSA-gjcg-vrxg-xmgv
- type: CVE
  value: CVE-2021-39162
permalink: https://github.com/advisories/GHSA-gjcg-vrxg-xmgv
publishedAt: "2021-09-10T17:54:01Z"
references:
- url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-j374-mjrw-vvp8
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-39162
- url: https://github.com/advisories/GHSA-gjcg-vrxg-xmgv
summary: Incorrect handling of H2 GOAWAY + SETTINGS frames
updatedAt: "2021-09-13T20:31:12Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 0.15.1
  package:
    name: github.com/pomerium/pomerium
  severity: HIGH
  updatedAt: "2021-09-10T16:32:17Z"
  vulnerableVersionRange: < 0.15.1
