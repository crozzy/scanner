description: The package `github.com/pires/go-proxyproto` before 0.5.0 are vulnerable
  to Denial of Service (DoS) via the parseVersion1() function. The reader in this
  package is a default bufio.Reader wrapping a net.Conn. It will read from the connection
  until it finds a newline. Since no limits are implemented in the code, a deliberately
  malformed V1 header could be used to exhaust memory in a server process using this
  code - and create a DoS. This can be exploited by sending a stream starting with
  PROXY and continuing to send data (which does not contain a newline) until the target
  stops acknowledging. The risk here is small, because only trusted sources should
  be allowed to send proxy protocol headers.
ghsaId: GHSA-fqh4-rh59-xhvf
identifiers:
- type: GHSA
  value: GHSA-fqh4-rh59-xhvf
- type: CVE
  value: CVE-2021-23351
permalink: https://github.com/advisories/GHSA-fqh4-rh59-xhvf
publishedAt: "2021-05-18T21:07:43Z"
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-23351
- url: https://github.com/advisories/GHSA-fqh4-rh59-xhvf
summary: Denial of service
updatedAt: "2021-05-18T21:07:43Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 0.5.0
  package:
    name: github.com/pires/go-proxyproto
  severity: MODERATE
  updatedAt: "2021-05-18T21:03:40Z"
  vulnerableVersionRange: < 0.5.0
