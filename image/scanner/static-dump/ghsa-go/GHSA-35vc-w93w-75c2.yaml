description: |-
  ### Impact
  Using programmatic access on protected sites, one can get a signed login URL with pomerium_redirect_uri set to an arbitrary URL. Then, if the user has already logged into Pomerium, they will be redirected to the specified pomerium_redirect_uri with a JWT attached. This allows an outside attacker to get a signed login URL that, upon visiting it, will redirect a victim to the attacker’s site. This creates an issue of Open Redirect and, more seriously, JWT leakage.

  With a leaked JWT, the attacker will be able to unveil the victim’s identity (.e.g. email address) by supplying the JWT to the authenticate service or verify.pomerium.com. In addition, if an application integrating Pomerium only verifies the iss claim and others but not the aud claim, the attacker will be able to access it as the victim.

  ### Patches
  Patched in Pomerium v0.13.4

  ### For more information
  If you have any questions or comments about this advisory
  * Open an issue in [pomerium](http://github.com/pomerium/pomerium)
  * Email us at [security@pomerium.com](mailto:security@pomerium.com)
ghsaId: GHSA-35vc-w93w-75c2
identifiers:
- type: GHSA
  value: GHSA-35vc-w93w-75c2
- type: CVE
  value: CVE-2021-29651
permalink: https://github.com/advisories/GHSA-35vc-w93w-75c2
publishedAt: "2021-05-21T16:24:34Z"
references:
- url: https://github.com/pomerium/pomerium/security/advisories/GHSA-35vc-w93w-75c2
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-29651
- url: https://github.com/advisories/GHSA-35vc-w93w-75c2
summary: JWT leak via Open Redirect in Programmatic access
updatedAt: "2021-05-21T16:24:34Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 0.13.4
  package:
    name: github.com/pomerium/pomerium/proxy
  severity: HIGH
  updatedAt: "2021-05-20T20:25:40Z"
  vulnerableVersionRange: < 0.13.4
- firstPatchedVersion:
    identifier: 0.13.4
  package:
    name: github.com/pomerium/pomerium
  severity: HIGH
  updatedAt: "2021-05-20T20:25:40Z"
  vulnerableVersionRange: < 0.13.4
