description: "### Impact\nThe filename that is given in [c.Attachment()](https://docs.gofiber.io/ctx#attachment)
  is not escaped, and therefore vulnerable for a CRLF injection attack. I.e. an attacker
  could upload a custom filename and then give the link to the victim. With this filename,
  the attacker can change the name of the downloaded file, redirect to another site,
  change the authorization header, etc.\n\n### Steps to reproduce\n```go\npackage
  main\n\nimport \"github.com/gofiber/fiber\"\n\nconst badFileName = \"another secret
  document.pdf\\\"\\r\\nLocation: google.com\\r\\nAuthorization: \\\"example_of_session_fixation\"\n\nfunc
  splitTheResponse(c *fiber.Ctx) {\n\tc.Attachment(badFileName)\n}\n\nfunc main()
  {\n\tapp := fiber.New()\n\tapp.Get(\"/attack\", splitTheResponse)\n\tapp.Listen(\"127.0.0.1:8080\")\n}\n```\n```\nHTTP/1.1
  200 OK\nDate: Fri, 10 Jul 2020 19:47:04 GMT\nContent-Type: application/octet-stream\nContent-Length:
  0\nContent-Disposition: attachment; filename=\"another secret document.pdf\"\nLocation:
  google.com\nAuthorization: \"example_of_session_fixation\"\n```\n\n### Patches\nThis
  issue has been patched in `v1.12.6` with commit [579](https://github.com/gofiber/fiber/pull/579/commits/f698b5d5066cfe594102ae252cd58a1fe57cf56f)
  escaping the filename by default.\n\n### Workarounds\nYou could of course serialize
  the input yourself before passing it to `ctx.Attachment()`, this is actually a good
  practice by default. But in case you forget, we got you covered \U0001F44D \n\n###
  References\nA CRLF injection attack is one of several types of injection attacks.
  It can be used to escalate to more malicious attacks such as Cross-site Scripting
  (XSS), page injection, web cache poisoning, cache-based defacement, and more. A
  CRLF injection vulnerability exists if an attacker can inject the CRLF characters
  into a web application, for example using a user input form or an HTTP request,
  [see acunetix](https://www.acunetix.com/websitesecurity/crlf-injection/)\n\n###
  For more information\nIf you have any questions or comments about this advisory:\n*
  Open an issue in [gofiber/fiber](https://github.com/gofiber/fiber)\n* Join us on
  [Discord](https://gofiber.io/discord)"
ghsaId: GHSA-9cx9-x2gp-9qvh
identifiers:
- type: GHSA
  value: GHSA-9cx9-x2gp-9qvh
- type: CVE
  value: CVE-2020-15111
permalink: https://github.com/advisories/GHSA-9cx9-x2gp-9qvh
publishedAt: "2021-06-29T21:24:28Z"
references:
- url: https://github.com/gofiber/fiber/security/advisories/GHSA-9cx9-x2gp-9qvh
- url: https://nvd.nist.gov/vuln/detail/CVE-2020-15111
- url: https://github.com/advisories/GHSA-9cx9-x2gp-9qvh
summary: CRLF vulnerability in Fiber
updatedAt: "2021-10-08T20:36:02Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 1.12.6
  package:
    name: github.com/gofiber/fiber
  severity: MODERATE
  updatedAt: "2021-05-24T19:14:18Z"
  vulnerableVersionRange: < 1.12.6
