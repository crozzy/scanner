description: |-
  ### Impact
  By crafting a malicious root filesystem (with `/proc` being a symlink to a directory which was inside a volume shared with another running container), an attacker in control of both containers can trick `runc` into not correctly configuring the container&amp;amp;amp;amp;#39;s security labels and not correctly masking paths inside `/proc` which contain potentially-sensitive information about the host (or even allow for direct attacks against the host).

  In order to exploit this bug, an untrusted user must be able to spawn custom containers with custom mount configurations (such that a volume is shared between two containers). It should be noted that we consider this to be a fairly high level of access for an untrusted user -- and we do not recommend allowing completely untrusted users to have such degrees of access without further restrictions.

  ### Patches
  This vulnerability has been fixed in `1.0.0-rc10`. It should be noted that the current fix is effectively a hot-fix, and there are known ways for it to be worked around (such as making the entire root filesystem a shared volume controlled by another container). We recommend that users review their access policies to ensure that untrusted users do not have such high levels of controls over container mount configuration.

  ### Workarounds
  If you are not providing the ability for untrusted users to configure mountpoints for `runc` (or through a higher-level tool such as `docker run -v`) then you are not vulnerable to this issue. This exploit requires fairly complicated levels of access (which are available for some public clouds but are not necessarily available for all deployments).

  Additionally, it appears as though it is not possible to exploit this vulnerability through Docker (due to the order of mounts Docker generates). However you should not depend on this, as it may be possible to work around this roadblock.

  ### Credits
  This vulnerability was discovered by Cure53, as part of a third-party security audit.

  ### For more information
  If you have any questions or comments about this advisory:
  * [Open an issue](https://github.com/opencontainers/runc/issues/new).
  * Email us at [dev@opencontainers.org](mailto:dev@opencontainers.org), or [security@opencontainers.org](mailto:security@opencontainers.org) if you think you&amp;amp;amp;amp;#39;ve found a security bug.
ghsaId: GHSA-fh74-hm69-rqjw
identifiers:
- type: GHSA
  value: GHSA-fh74-hm69-rqjw
- type: CVE
  value: CVE-2019-19921
permalink: https://github.com/advisories/GHSA-fh74-hm69-rqjw
publishedAt: "2021-05-27T18:41:17Z"
references:
- url: https://github.com/opencontainers/runc/security/advisories/GHSA-fh74-hm69-rqjw
- url: https://nvd.nist.gov/vuln/detail/CVE-2019-19921
- url: https://github.com/advisories/GHSA-fh74-hm69-rqjw
summary: procfs race condition with a shared volume mount
updatedAt: "2021-05-27T18:41:17Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 1.0.0
  package:
    name: github.com/opencontainers/runc/libcontainer
  severity: MODERATE
  updatedAt: "2021-05-24T21:20:42Z"
  vulnerableVersionRange: < 1.0.0
