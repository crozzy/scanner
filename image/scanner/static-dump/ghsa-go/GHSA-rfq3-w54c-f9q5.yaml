description: |-
  ### Impact

  [fosite#400](https://github.com/ory/fosite/pull/400) (released as v0.30.2) introduced a new feature for handling redirect URLs pointing to loopback interfaces ([rfc8252#section-7.3](https://tools.ietf.org/html/rfc8252#section-7.3)). As part of that change new behavior was introduced which failed to respect the redirect URL's (only for loopback interfaces!) query parameters

  1. Registering a client with allowed redirect URL `http://127.0.0.1/callback`
  2. Performing OAuth2 flow and requesting redirect URL `http://127.0.0.1/callback?bar=foo`
  3. Instead of an error, the browser is redirected to `http://127.0.0.1/callback?bar=foo` with a potentially successful OAuth2 response.

  as well as the host parameter (as long as the host is a loopback interface):

  1. Registering a client with allowed redirect URL `https://example.com/callback`
  2. Performing OAuth2 flow and requesting redirect URL `http://127.0.0.1/callback`
  3. Instead of an error, the browser is redirected to `http://127.0.0.1/callback` with a potentially successful OAuth2 response.

  These bugs are only applicable in scenarios where the attacker has control over the loopback interface (`localhost`, `127.0.0.1`, `[::1]`) where the browser performing the OAuth2 flow is running.
ghsaId: GHSA-rfq3-w54c-f9q5
identifiers:
- type: GHSA
  value: GHSA-rfq3-w54c-f9q5
- type: CVE
  value: CVE-2020-15233
permalink: https://github.com/advisories/GHSA-rfq3-w54c-f9q5
publishedAt: "2021-05-24T17:00:12Z"
references:
- url: https://github.com/ory/fosite/security/advisories/GHSA-rfq3-w54c-f9q5
- url: https://nvd.nist.gov/vuln/detail/CVE-2020-15233
- url: https://github.com/advisories/GHSA-rfq3-w54c-f9q5
summary: OAuth2 Redirect URL validity does not respect query parameters and character
  casing for loopback addresses
updatedAt: "2021-05-24T17:00:12Z"
vulnerabilities:
- firstPatchedVersion:
    identifier: 0.34.1
  package:
    name: github.com/ory/fosite
  severity: MODERATE
  updatedAt: "2021-05-21T22:14:39Z"
  vulnerableVersionRange: '>= 0.30.3, < 0.34.1'
